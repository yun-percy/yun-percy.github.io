---

title: dos2unix：一条命令搞定换行符问题
category: 语法
tags:
  - xargs
  - find
  - 换行符
  - dos2unix
---

> 项目伊始，开始拿着代码搭构建,刚开始无疑是痛苦的，各种编译出错。只能一个个解决，今天解掉了换行符问题，于是记录一下。

背景
-----


+ windows中的换行符是\r\n，
+ linux/unix下的换行符是\n。

其中:
回车符：\r=0x0d  (13)          return； #回车（carriage return）
换行符：\n=0x0a (10)           newline。#换行（newline）

文本文件的行结束符,windows 用 CRLF，mac用CR，unix 用 LF。【CR -- 回车符，c语言'\r'】。【LF -- 换行符， c语言'\n'】。

思路
-----

整个项目开发环境比较复杂，大多数是用windows进行开发。但是一些公共组件是采用的mac，还有一些脚本类是采用的linux开发。所以，所有的文本都有可能换行符不会。

首先，我们要找出所有的文件

`find . -type f`

找到之后，我们要对每个文件进行检测，是什么换行符

`file $file > file.txt`

然后过滤出windows的换行符出来，既过滤带有 `CRLF`关键字的输出

`cat file.txt| grep CRLF >output.txt`

分离出文件

```sh
while read line;do
    echo $line |awk -F : '{print $1}'>output2.txt
done< output.txt
```

最后进行转换处理

```sh
while read line;do
    dos2unix $line
done< output2.txt
```

整个过程就搞定了

写代码
----

`find . -type f| xargs file | grep CRLF| awk -F : '{print $1}'|xargs dos2unix`

就完成了上面第二步中所有的代码
